# 🔧 دليل المدير الشامل - OmniCRM God Mode
## كل إعداد وكل خيار تقني بالتفصيل

<div dir="rtl">

---

## 📑 جدول المحتويات

1. [التثبيت الأول](#التثبيت-الأول)
2. [لوحة تحكم المدير](#لوحة-تحكم-المدير)
3. [إدارة المستخدمين والصلاحيات](#إدارة-المستخدمين)
4. [إعدادات الذكاء الاصطناعي](#إعدادات-ai)
5. [تكاملات خارجية](#التكاملات)
6. [النسخ الاحتياطي والاستعادة](#النسخ-الاحتياطي)
7. [المراقبة والصيانة](#المراقبة)
8. [الأمان والحماية](#الأمان)
9. [استكشاف الأخطاء](#استكشاف-الأخطاء)
10. [التحديثات](#التحديثات)

---

## 🚀 التثبيت الأول

### المتطلبات الأساسية:

```bash
# تحقق من المتطلبات
docker --version    # يجب: Docker 20.10+
docker-compose --version  # يجب: 2.0+
node --version     # يجب: Node.js 18+
python --version   # يجب: Python 3.11+
```

### خطوات التثبيت التفصيلية:

#### **الخطوة 1: استنساخ المشروع**

```bash
# استنسخ من GitHub
git clone https://github.com/admragy/NeuroCRM-GodMode.git

# ادخل المجلد
cd NeuroCRM-GodMode

# تحقق من النسخة
git log --oneline -1
# يجب أن ترى: acd6870 ✨ Add production status dashboard script
```

#### **الخطوة 2: إعداد البيئة**

```bash
# انسخ قالب الإعدادات
cp .env.production.template .env

# افتح الملف للتحرير
nano .env
```

**إعدادات إجبارية (يجب تغييرها):**

```bash
# 🔐 مفاتيح الأمان (ولّدها فوراً!)
SECRET_KEY=$(python -c "import secrets; print(secrets.token_urlsafe(32))")
JWT_SECRET_KEY=$(python -c "import secrets; print(secrets.token_urlsafe(32))")
ENCRYPTION_KEY=$(python -c "import secrets; print(secrets.token_urlsafe(32))")

# 🗄️ قاعدة البيانات
DATABASE_URL=postgresql://omnicrm:STRONG_PASSWORD@postgres:5432/omnicrm_prod
POSTGRES_PASSWORD=STRONG_PASSWORD  # غيّر هذه!

# 📦 Redis
REDIS_PASSWORD=ANOTHER_STRONG_PASSWORD  # غيّر هذه!

# 🤖 الذكاء الاصطناعي (اختر واحد على الأقل)
AI_PROVIDER=groq  # أو: openai, claude, google, ollama

# إذا اخترت Groq (مجاني):
GROQ_API_KEY=gsk_your_free_key_here

# إذا اخترت OpenAI (مدفوع):
OPENAI_API_KEY=sk-proj-your_key_here

# إذا اخترت Ollama (محلي):
OLLAMA_BASE_URL=http://localhost:11434
```

**حفظ وإغلاق:** `Ctrl+X` ثم `Y` ثم `Enter`

#### **الخطوة 3: توليد المفاتيح الآمنة**

```bash
# سكريبت سريع لتوليد جميع المفاتيح
python3 << EOF
import secrets
print("# 🔐 المفاتيح الآمنة المولدة:")
print(f"SECRET_KEY={secrets.token_urlsafe(32)}")
print(f"JWT_SECRET_KEY={secrets.token_urlsafe(32)}")
print(f"ENCRYPTION_KEY={secrets.token_urlsafe(32)}")
print(f"BACKUP_ENCRYPTION_KEY={secrets.token_urlsafe(32)}")
print(f"POSTGRES_PASSWORD={secrets.token_urlsafe(16)}")
print(f"REDIS_PASSWORD={secrets.token_urlsafe(16)}")
EOF

# انسخ المخرجات والصقها في ملف .env
```

#### **الخطوة 4: بناء ونشر النظام**

**الطريقة 1: نشر آلي (موصى به)**

```bash
# اجعل سكريبت النشر قابل للتنفيذ
chmod +x scripts/deploy.sh

# شغّل النشر الآلي
sudo ./scripts/deploy.sh

# السكريبت سيقوم بـ:
# ✅ فحص المتطلبات
# ✅ بناء Docker images
# ✅ إنشاء قاعدة البيانات
# ✅ تشغيل Migrations
# ✅ بدء الخدمات
# ✅ فحص الصحة
```

**الطريقة 2: نشر يدوي**

```bash
# 1. بناء الصور
docker-compose -f docker-compose.prod.yml build

# 2. تشغيل قاعدة البيانات أولاً
docker-compose -f docker-compose.prod.yml up -d postgres redis

# 3. انتظر 10 ثواني
sleep 10

# 4. تشغيل Migrations
docker-compose -f docker-compose.prod.yml run --rm app \
  python -m alembic upgrade head

# 5. تشغيل جميع الخدمات
docker-compose -f docker-compose.prod.yml up -d

# 6. تحقق من الحالة
docker-compose -f docker-compose.prod.yml ps
```

#### **الخطوة 5: إنشاء حساب المدير**

```bash
# شغّل سكريبت إنشاء المدير
docker-compose exec app python scripts/create_admin.py

# أو بدون Docker:
python scripts/create_admin.py
```

**التفاعل مع السكريبت:**

```
🔐 إنشاء حساب مدير جديد
================================

📧 البريد الإلكتروني: admin@omnicrm.app
✅ البريد صالح!

🔒 كلمة المرور: 
✅ قوة كلمة المرور: قوية (95/100)

🔒 تأكيد كلمة المرور: 
✅ كلمات المرور متطابقة!

👤 الاسم الكامل: مدير النظام

🏢 اسم المؤسسة: OmniCRM

✅ تم إنشاء المدير بنجاح!

📝 معلومات الدخول:
   البريد: admin@omnicrm.app
   كلمة المرور: [المحفوظة بشكل آمن]
   
🔗 رابط الدخول:
   http://localhost:8000/admin
```

#### **الخطوة 6: التحقق من النشر**

```bash
# فحص الصحة
curl http://localhost:8000/health

# يجب أن ترى:
{
  "status": "healthy",
  "version": "7.1.0",
  "database": "connected",
  "redis": "connected",
  "ai_provider": "groq"
}

# فحص السجلات
docker-compose logs app --tail=50

# فحص حالة الخدمات
docker-compose ps

# يجب أن ترى:
NAME                COMMAND                  SERVICE      STATUS
omnicrm-app         "uvicorn main:app..."   app          Up (healthy)
omnicrm-postgres    "docker-entrypoint..."  postgres     Up (healthy)
omnicrm-redis       "redis-server..."       redis        Up (healthy)
```

#### **الخطوة 7: الوصول لأول مرة**

1. افتح المتصفح:
   ```
   http://localhost:8000
   ```

2. سجّل دخول بحساب المدير:
   ```
   البريد: admin@omnicrm.app
   كلمة المرور: [التي أنشأتها]
   ```

3. **ستظهر رسالة ترحيب:**
   ```
   🎉 مرحباً في OmniCRM God Mode!
   
   هذه أول زيارة لك. دعنا نبدأ الإعداد:
   
   1. ✅ حساب المدير جاهز
   2. ⚙️ إعداد الذكاء الاصطناعي
   3. 🔗 ربط التكاملات
   4. 📊 استيراد البيانات
   
   [ابدأ الإعداد] [تخطي وابدأ الآن]
   ```

---

## 🎛️ لوحة تحكم المدير

### الوصول:
```
http://your-domain.com/admin
```

### الصلاحيات المطلوبة:
- ✅ حساب مدير (role: admin)
- ✅ صلاحيات كاملة

### شكل لوحة المدير:

```
┌──────────────────────────────────────────────────────────┐
│ 🔧 لوحة تحكم المدير                      👤 Admin    ▼│
├──────────────────────────────────────────────────────────┤
│                                                          │
│  📊 نظرة عامة | 👥 المستخدمين | 🤖 الذكاء الاصطناعي   │
│  🔗 التكاملات | 💾 النسخ الاحتياطي | 📊 المراقبة       │
│  ⚙️ الإعدادات | 🔐 الأمان | 📝 السجلات                │
│                                                          │
├──────────────────────────────────────────────────────────┤
│                                                          │
│  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐       │
│  │ 👥 المستخدمين│ │ 🏢 المؤسسات │ │ 📊 الطلبات  │       │
│  │    247      │ │     12      │ │   1,542    │       │
│  │  +8 جديد   │ │   3 نشطة   │ │  اليوم: 42 │       │
│  └─────────────┘ └─────────────┘ └─────────────┘       │
│                                                          │
│  ┌─────────────────────────────────────────────────┐   │
│  │ 📈 صحة النظام                                   │   │
│  ├─────────────────────────────────────────────────┤   │
│  │ CPU: 🟢 25%  ████░░░░░░                         │   │
│  │ RAM: 🟢 45%  ████████░░                         │   │
│  │ Disk: 🟢 32% ██████░░░░                        │   │
│  │ DB Connections: 15/100                          │   │
│  │ Redis: 🟢 Connected                             │   │
│  │ Uptime: 15 days, 3 hours                        │   │
│  └─────────────────────────────────────────────────┘   │
│                                                          │
│  ┌─────────────────────────────────────────────────┐   │
│  │ ⚠️ التنبيهات الحرجة                            │   │
│  ├─────────────────────────────────────────────────┤   │
│  │ 🔴 Backup: فشل النسخ الاحتياطي - منذ ساعة      │   │
│  │ 🟡 Disk: المساحة أقل من 20% - 15 GB متبقي      │   │
│  │ 🟢 System: كل شيء يعمل بشكل طبيعي              │   │
│  └─────────────────────────────────────────────────┘   │
│                                                          │
└──────────────────────────────────────────────────────────┘
```

---

## 👥 إدارة المستخدمين والصلاحيات

### الأدوار المتاحة:

| الدور | الصلاحيات | الوصول |
|------|-----------|--------|
| **Super Admin** | كامل التحكم | جميع الأقسام + لوحة المدير |
| **Admin** | إدارة المؤسسة | كامل عدا إعدادات النظام |
| **Manager** | إدارة الفريق | العملاء + الصفقات + التقارير |
| **Sales** | المبيعات | العملاء + الصفقات (قراءة/كتابة) |
| **Support** | الدعم | العملاء (قراءة) + الرسائل |
| **Viewer** | عرض فقط | التقارير والإحصائيات |

### إضافة مستخدم جديد:

1. **اذهب إلى:** `المدير > المستخدمين > [+ مستخدم جديد]`

2. **نموذج الإضافة:**
   ```
   ┌─────────────────────────────────────────────┐
   │ ➕ إضافة مستخدم جديد                        │
   ├─────────────────────────────────────────────┤
   │ 👤 المعلومات الأساسية                      │
   │                                             │
   │ الاسم الكامل: *                             │
   │ [_______________]                           │
   │                                             │
   │ البريد الإلكتروني: *                       │
   │ [_______________]                           │
   │                                             │
   │ رقم الهاتف:                                 │
   │ [+966 ___ ___ ___]                         │
   │                                             │
   │ ─────────────────────────────────────────   │
   │ 🔐 الصلاحيات والأمان                       │
   │                                             │
   │ الدور: *                                    │
   │ ⚪ Super Admin (⚠️ خطر!)                   │
   │ ⚪ Admin                                    │
   │ ⚪ Manager                                  │
   │ ⚪ Sales (افتراضي)                         │
   │ ⚪ Support                                  │
   │ ⚪ Viewer                                   │
   │                                             │
   │ المؤسسة: *                                  │
   │ [▼ اختر المؤسسة...]                       │
   │                                             │
   │ كلمة المرور: *                              │
   │ [_______________] [🎲 توليد تلقائي]       │
   │ القوة: ⬜⬜⬜⬜⬜ ضعيفة                     │
   │                                             │
   │ ☑️ إرسال دعوة بالبريد الإلكتروني          │
   │ ☑️ طلب تغيير كلمة المرور عند الدخول الأول│
   │ ☐ تفعيل المصادقة الثنائية (2FA)           │
   │                                             │
   │ ─────────────────────────────────────────   │
   │ ⚙️ إعدادات إضافية                         │
   │                                             │
   │ الحد الأقصى للجلسات المتزامنة:              │
   │ [▼ 3]                                      │
   │                                             │
   │ انتهاء الجلسة بعد:                          │
   │ [▼ 8 ساعات]                               │
   │                                             │
   │ قيود IP (اختياري):                         │
   │ [_______________]                           │
   │ مثال: 192.168.1.0/24                       │
   │                                             │
   │ [💾 إنشاء المستخدم] [❌ إلغاء]            │
   └─────────────────────────────────────────────┘
   ```

3. **بعد الإنشاء:**
   ```
   ✅ تم إنشاء المستخدم بنجاح!
   
   📧 تم إرسال دعوة إلى: user@example.com
   
   📋 بيانات الدخول:
   • البريد: user@example.com
   • كلمة المرور المؤقتة: [تم الإرسال بالبريد]
   • رابط التفعيل: https://domain.com/activate/abc123
   
   [👁️ عرض المستخدم] [✏️ تحرير] [🔙 العودة للقائمة]
   ```

### إدارة الصلاحيات المتقدمة:

1. **اذهب إلى:** `المدير > المستخدمين > [اختر مستخدم] > الصلاحيات`

2. **مصفوفة الصلاحيات:**
   ```
   ┌──────────────────────────────────────────────┐
   │ 🔐 صلاحيات تفصيلية: أحمد محمد (Sales)       │
   ├──────────────────────────────────────────────┤
   │                                              │
   │ القسم         │ عرض │ إضافة │ تحرير │ حذف  │
   ├─────────────┼─────┼──────┼──────┼──────┤
   │ العملاء     │ ✅  │  ✅  │  ✅  │  ❌  │
   │ الصفقات     │ ✅  │  ✅  │  ✅  │  ❌  │
   │ المنتجات    │ ✅  │  ❌  │  ❌  │  ❌  │
   │ الحملات     │ ✅  │  ❌  │  ❌  │  ❌  │
   │ التقارير    │ ✅  │  ❌  │  ❌  │  ❌  │
   │ الإعدادات   │ ❌  │  ❌  │  ❌  │  ❌  │
   │ المستخدمين  │ ❌  │  ❌  │  ❌  │  ❌  │
   │ الفواتير    │ ❌  │  ❌  │  ❌  │  ❌  │
   └──────────────────────────────────────────────┘
   
   [✏️ تعديل الصلاحيات] [📋 نسخ من مستخدم آخر]
   ```

3. **صلاحيات خاصة:**
   ```
   ☑️ الوصول لـ API
   ☑️ تصدير البيانات
   ☐ حذف البيانات الدائم
   ☐ الوصول لسجلات النظام
   ☐ تغيير إعدادات المؤسسة
   ```

---

## 🤖 إعدادات الذكاء الاصطناعي

### الوصول:
```
المدير > الذكاء الاصطناعي > الإعدادات
```

### واجهة الإعدادات:

```
┌──────────────────────────────────────────────────────┐
│ 🤖 إعدادات الذكاء الاصطناعي                         │
├──────────────────────────────────────────────────────┤
│                                                      │
│  ┌────────────────────────────────────────────┐    │
│  │ 1️⃣ اختيار محرك الذكاء الاصطناعي          │    │
│  ├────────────────────────────────────────────┤    │
│  │                                            │    │
│  │ المحرك الرئيسي: *                         │    │
│  │ [▼ اختر المحرك...]                       │    │
│  │   • OpenAI GPT-4o (مدفوع - أفضل جودة)    │    │
│  │   • Anthropic Claude (مدفوع - تحليل)     │    │
│  │   • Google Gemini (مدفوع/مجاني)          │    │
│  │   • Groq (مجاني - أسرع) ⚡ ← محدد        │    │
│  │   • Ollama (محلي - خصوصية 100%)          │    │
│  │   • Auto (تبديل تلقائي)                  │    │
│  │                                            │    │
│  │ ℹ️ المحرك الحالي: Groq                    │    │
│  │ الحالة: 🟢 متصل ومجاني                   │    │
│  │ الاستخدام اليوم: 142 طلب (من 1000 مجاني)│    │
│  └────────────────────────────────────────────┘    │
│                                                      │
│  ┌────────────────────────────────────────────┐    │
│  │ 2️⃣ مفاتيح API                              │    │
│  ├────────────────────────────────────────────┤    │
│  │                                            │    │
│  │ 🔵 OpenAI API Key:                         │    │
│  │ [sk-proj-••••••••••••] [عرض] [تحرير]     │    │
│  │ ☐ مفعّل | آخر استخدام: لم يُستخدم         │    │
│  │                                            │    │
│  │ 🔴 Anthropic API Key:                      │    │
│  │ [غير مُعرّف] [إضافة مفتاح]               │    │
│  │ ☐ غير مفعّل                               │    │
│  │                                            │    │
│  │ 🟢 Google API Key:                         │    │
│  │ [AIza••••••••••] [عرض] [تحرير]           │    │
│  │ ☐ مفعّل | آخر استخدام: منذ 3 ساعات       │    │
│  │                                            │    │
│  │ 🟣 Groq API Key:                           │    │
│  │ [gsk_••••••••••] [عرض] [تحرير]           │    │
│  │ ☑️ مفعّل ونشط | آخر استخدام: منذ دقيقتين │    │
│  │                                            │    │
│  │ 🟠 Ollama:                                 │    │
│  │ [http://localhost:11434] [اختبار]         │    │
│  │ ☐ غير متصل | الموديل: llama3.2:7b        │    │
│  │                                            │    │
│  │ [💾 حفظ المفاتيح] [🧪 اختبار الكل]       │    │
│  └────────────────────────────────────────────┘    │
│                                                      │
│  ┌────────────────────────────────────────────┐    │
│  │ 3️⃣ إعدادات الأداء                         │    │
│  ├────────────────────────────────────────────┤    │
│  │                                            │    │
│  │ Temperature (الإبداعية):                  │    │
│  │ [━━━━━━●━━━] 0.7                          │    │
│  │ منخفض (دقيق) ←→ مرتفع (إبداعي)          │    │
│  │                                            │    │
│  │ Max Tokens (طول الإجابة):                 │    │
│  │ [━━━━━━━━●━] 2000                         │    │
│  │ قصير (500) ←→ طويل (4000)                │    │
│  │                                            │    │
│  │ Timeout (مهلة الاستجابة):                 │    │
│  │ [━━━●━━━━━━] 30 ثانية                    │    │
│  │                                            │    │
│  │ ☑️ إعادة المحاولة عند الفشل (3 مرات)     │    │
│  │ ☑️ تخزين النتائج مؤقتاً (Cache)           │    │
│  └────────────────────────────────────────────┘    │
│                                                      │
│  ┌────────────────────────────────────────────┐    │
│  │ 4️⃣ حدود الاستخدام والتكلفة               │    │
│  ├────────────────────────────────────────────┤    │
│  │                                            │    │
│  │ الحد اليومي للطلبات:                      │    │
│  │ [___1000___] طلب/يوم                      │    │
│  │ الاستخدام اليوم: 142/1000 (14%)          │    │
│  │ [▓▓░░░░░░░░] ← آمن                        │    │
│  │                                            │    │
│  │ الحد الشهري للتكلفة:                      │    │
│  │ [___50___] دولار/شهر                      │    │
│  │ التكلفة هذا الشهر: $0 (Groq مجاني)       │    │
│  │                                            │    │
│  │ ⚠️ عند الوصول للحد:                       │    │
│  │ ⚪ إيقاف الخدمة                           │    │
│  │ ⚪ التحويل لمحرك مجاني (Groq/Ollama)     │    │
│  │ ⚪ إرسال تنبيه فقط                        │    │
│  └────────────────────────────────────────────┘    │
│                                                      │
│  ┌────────────────────────────────────────────┐    │
│  │ 5️⃣ خيارات متقدمة                          │    │
│  ├────────────────────────────────────────────┤    │
│  │                                            │    │
│  │ ☑️ تفعيل تحليل المشاعر (Sentiment)        │    │
│  │ ☑️ كشف اللغة التلقائي                     │    │
│  │ ☑️ تحسين الردود العربية                  │    │
│  │ ☐ حفظ سجل المحادثات (GDPR)               │    │
│  │ ☐ استخدام Context من المحادثات السابقة   │    │
│  │                                            │    │
│  │ Prompt الأساسي (System Prompt):           │    │
│  │ [_____________________________]            │    │
│  │ [_____________________________]            │    │
│  │ [استعادة الافتراضي]                       │    │
│  └────────────────────────────────────────────┘    │
│                                                      │
│  [💾 حفظ جميع الإعدادات] [🔄 استعادة الافتراضي]  │
│                                                      │
└──────────────────────────────────────────────────────┘
```

### اختبار المحركات:

```bash
# من لوحة المدير
اضغط [🧪 اختبار الكل]

# نافذة الاختبار تظهر:
┌──────────────────────────────────────────┐
│ 🧪 اختبار محركات الذكاء الاصطناعي       │
├──────────────────────────────────────────┤
│ جاري الاختبار...                        │
│                                          │
│ ✅ Groq: متصل (80ms) ⚡ FASTEST         │
│ ⏳ OpenAI: جاري الاختبار...             │
│ ❌ Claude: API key not configured        │
│ ✅ Gemini: متصل (180ms)                 │
│ ⚠️ Ollama: Not running (localhost:11434)│
│                                          │
│ 📊 النتيجة:                             │
│ • الأسرع: Groq (80ms)                   │
│ • المتاح: 2 من 5 محركات                │
│ • الموصى به: Groq (مجاني + سريع)       │
│                                          │
│ [🔄 إعادة الاختبار] [✅ حفظ]           │
└──────────────────────────────────────────┘
```

---

## 🔗 التكاملات الخارجية

### WhatsApp Business:

1. **اذهب إلى:** `المدير > التكاملات > WhatsApp`

2. **خيارات الربط:**
   ```
   ┌──────────────────────────────────────────┐
   │ 📱 ربط WhatsApp Business                │
   ├──────────────────────────────────────────┤
   │                                          │
   │ اختر طريقة الربط:                       │
   │                                          │
   │ ⚪ WhatsApp Business API (موصى به)      │
   │    • أفضل للأعمال الكبيرة              │
   │    • تكلفة: من $50/شهر                  │
   │    • ميزات: Automation, Analytics       │
   │                                          │
   │ ⚪ WhatsApp Cloud API (Meta)             │
   │    • مجاني حتى 1000 محادثة/شهر         │
   │    • يحتاج: Facebook Business Manager   │
   │                                          │
   │ ⚪ Twilio WhatsApp                       │
   │    • $0.005 لكل رسالة                   │
   │    • سهل الإعداد                        │
   │                                          │
   │ [التالي: الإعداد →]                     │
   └──────────────────────────────────────────┘
   ```

3. **إعداد Cloud API:**
   ```
   1. اذهب إلى: https://business.facebook.com
   2. App Setup > WhatsApp
   3. انسخ:
      • Phone Number ID
      • Business Account ID
      • API Token
   4. الصقها هنا:
   
   Phone Number ID: [_______________]
   Business Account ID: [_______________]
   API Token: [_______________]
   Webhook Verify Token: [auto-generated]
   
   [اختبار الاتصال] [حفظ]
   ```

### Facebook Ads:

1. **اذهب إلى:** `المدير > التكاملات > Facebook Ads`

2. **نموذج الربط:**
   ```
   ┌──────────────────────────────────────────┐
   │ 📊 ربط Facebook Ads                     │
   ├──────────────────────────────────────────┤
   │                                          │
   │ الحصول على Access Token:                │
   │                                          │
   │ 1. [🔗 تسجيل دخول Facebook]             │
   │    ↓                                     │
   │ 2. منح الصلاحيات:                       │
   │    ☑️ ads_management                    │
   │    ☑️ ads_read                          │
   │    ☑️ business_management               │
   │    ↓                                     │
   │ 3. Access Token سيُملأ تلقائياً:        │
   │    [تم الحصول عليه ✅]                  │
   │                                          │
   │ Ad Account ID:                           │
   │ [act_________________]                   │
   │                                          │
   │ [اختبار ومزامنة الحملات]                │
   └──────────────────────────────────────────┘
   ```

---

## 💾 النسخ الاحتياطي والاستعادة

### النسخ التلقائي:

```bash
# عرض جدول النسخ
المدير > النسخ الاحتياطي > الجدول الزمني

┌──────────────────────────────────────────┐
│ ⏰ جدول النسخ الاحتياطي التلقائي       │
├──────────────────────────────────────────┤
│                                          │
│ التكرار: [▼ يومياً]                    │
│ الوقت: [▼ 02:00 صباحاً]                │
│ المنطقة الزمنية: Asia/Riyadh            │
│                                          │
│ نوع النسخة:                              │
│ ☑️ Full Backup (قاعدة البيانات كاملة)  │
│ ☑️ الملفات المرفوعة                     │
│ ☐ سجلات النظام                          │
│                                          │
│ الضغط: ☑️ تفعيل (gzip)                 │
│ التشفير: ☑️ تفعيل (AES-256)            │
│                                          │
│ الاحتفاظ:                                │
│ • يومي: آخر 7 نسخ                      │
│ • أسبوعي: آخر 4 نسخ                    │
│ • شهري: آخر 12 نسخة                    │
│                                          │
│ الوجهة:                                  │
│ ☑️ محلي (/opt/omnicrm/backups)          │
│ ☑️ AWS S3 (omnicrm-backups bucket)      │
│ ☐ Google Drive                          │
│ ☐ Dropbox                               │
│                                          │
│ [💾 حفظ الإعدادات] [▶️ نسخة فورية]    │
└──────────────────────────────────────────┘
```

### النسخ اليدوي:

```bash
# من الترمينال
docker-compose exec app python -m app.services.backup_service create

# أو من لوحة المدير
المدير > النسخ الاحتياطي > [▶️ نسخة فورية الآن]

# النافذة:
┌──────────────────────────────────────────┐
│ 💾 إنشاء نسخة احتياطية فورية            │
├──────────────────────────────────────────┤
│ جاري إنشاء النسخة...                    │
│                                          │
│ ✅ 1. تصدير قاعدة البيانات (5.2 MB)    │
│ ✅ 2. ضغط الملفات (gzip)                │
│ ✅ 3. التشفير (AES-256)                 │
│ ⏳ 4. الرفع إلى S3... (45%)             │
│                                          │
│ [███████████░░░░░░░░] 65%               │
│                                          │
│ الوقت المتبقي: ~ 30 ثانية               │
└──────────────────────────────────────────┘

# عند الانتهاء:
┌──────────────────────────────────────────┐
│ ✅ تمت النسخة الاحتياطية بنجاح!         │
├──────────────────────────────────────────┤
│ 📦 اسم الملف:                           │
│ omnicrm_backup_20260104_140532.sql.gz.enc│
│                                          │
│ 📊 الحجم: 4.8 MB (قبل الضغط: 15.2 MB)  │
│ 🔐 التشفير: AES-256                     │
│ ✅ Checksum: 7a3f8e...                   │
│                                          │
│ 📍 المواقع:                              │
│ • محلي: /opt/omnicrm/backups/           │
│ • S3: s3://omnicrm-backups/...          │
│                                          │
│ [📥 تحميل] [🔄 استعادة] [✅ حسناً]     │
└──────────────────────────────────────────┘
```

### استعادة من نسخة:

```bash
# خطوات الاستعادة:

1. المدير > النسخ الاحتياطي > قائمة النسخ

2. اختر النسخة المطلوبة:

┌──────────────────────────────────────────┐
│ 📋 قائمة النسخ الاحتياطية              │
├──────────────────────────────────────────┤
│                                          │
│ ┌────────────────────────────────────┐  │
│ │ 📅 4 يناير 2026 - 02:00 صباحاً    │  │
│ │ 📦 15.2 MB → 4.8 MB (ضغط 68%)     │  │
│ │ ✅ سليمة | S3 + محلي              │  │
│ │ [🔄 استعادة] [📥 تحميل]          │  │
│ └────────────────────────────────────┘  │
│                                          │
│ ┌────────────────────────────────────┐  │
│ │ 📅 3 يناير 2026 - 02:00 صباحاً    │  │
│ │ 📦 14.8 MB → 4.6 MB                │  │
│ │ ✅ سليمة | S3 + محلي              │  │
│ │ [🔄 استعادة] [📥 تحميل]          │  │
│ └────────────────────────────────────┘  │
│                                          │
└──────────────────────────────────────────┘

3. تأكيد الاستعادة:

┌──────────────────────────────────────────┐
│ ⚠️ تحذير: استعادة النسخة الاحتياطية    │
├──────────────────────────────────────────┤
│ أنت على وشك استعادة:                    │
│ 📅 4 يناير 2026 - 02:00 صباحاً         │
│                                          │
│ سيتم:                                    │
│ 🔴 حذف جميع البيانات الحالية           │
│ 🔄 استبدالها ببيانات النسخة            │
│                                          │
│ لا يمكن التراجع عن هذا الإجراء!         │
│                                          │
│ للتأكيد، اكتب: RESTORE                  │
│ [_______________]                        │
│                                          │
│ [⚠️ نعم، استعد الآن] [❌ إلغاء]        │
└──────────────────────────────────────────┘
```

---

## 📊 المراقبة والصيانة

### لوحة المراقبة:

```
المدير > المراقبة > نظرة عامة

┌──────────────────────────────────────────────────────┐
│ 📊 لوحة المراقبة الحية                              │
├──────────────────────────────────────────────────────┤
│                                                      │
│  ┌────────────────────────────────────────────┐    │
│  │ 💻 موارد الخادم                            │    │
│  ├────────────────────────────────────────────┤    │
│  │ CPU: 25% [████████░░░░░░░░░░] 🟢           │    │
│  │ RAM: 45% [████████████████░░░░] 🟢          │    │
│  │ Disk: 32% [██████████░░░░░░░░░] 🟢         │    │
│  │ Network: ↓15 MB/s  ↑5 MB/s                 │    │
│  └────────────────────────────────────────────┘    │
│                                                      │
│  ┌────────────────────────────────────────────┐    │
│  │ 🗄️ قاعدة البيانات                          │    │
│  ├────────────────────────────────────────────┤    │
│  │ الاتصالات: 15/100 🟢                       │    │
│  │ Slow Queries: 2 ⚠️ [عرض]                  │    │
│  │ حجم DB: 2.3 GB / 50 GB                     │    │
│  │ آخر Backup: منذ ساعة ✅                    │    │
│  └────────────────────────────────────────────┘    │
│                                                      │
│  ┌────────────────────────────────────────────┐    │
│  │ 📦 Redis Cache                              │    │
│  ├────────────────────────────────────────────┤    │
│  │ الحالة: 🟢 متصل                            │    │
│  │ Hit Rate: 87% ⬆️ ممتاز                     │    │
│  │ الذاكرة: 245 MB / 1 GB                     │    │
│  │ Keys: 1,247 مفتاح                          │    │
│  └────────────────────────────────────────────┘    │
│                                                      │
│  ┌────────────────────────────────────────────┐    │
│  │ 🤖 خدمات الذكاء الاصطناعي                 │    │
│  ├────────────────────────────────────────────┤    │
│  │ Groq: 🟢 متصل (80ms)                       │    │
│  │ OpenAI: 🟡 بطيء (500ms)                    │    │
│  │ Ollama: 🔴 غير متصل                        │    │
│  │ الاستخدام اليوم: 142/1000                  │    │
│  └────────────────────────────────────────────┘    │
│                                                      │
│  ┌────────────────────────────────────────────┐    │
│  │ ⚡ الأداء                                   │    │
│  ├────────────────────────────────────────────┤    │
│  │ متوسط وقت الاستجابة: 150ms ✅              │    │
│  │ أبطأ endpoint: /api/ai/generate (800ms)    │    │
│  │ Uptime: 15 يوم، 3 ساعات                    │    │
│  │ Errors (24h): 3 ⚠️ [عرض السجل]            │    │
│  └────────────────────────────────────────────┘    │
│                                                      │
└──────────────────────────────────────────────────────┘
```

---

السؤال: **هل تريد أن أكمل باقي الأقسام (الأمان، استكشاف الأخطاء، التحديثات) + رفع جميع الملفات على GitHub؟**

أم نكتفي بهذا القدر ونرفع ما تم إنجازه؟

</div>
